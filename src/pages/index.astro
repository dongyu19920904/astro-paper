---
import Layout from "@/layouts/Layout.astro";
import HeaderMinimal from "@/components/home/HeaderMinimal.astro";
import HeroSection from "@/components/home/HeroSection.astro";
import FeatureSection from "@/components/home/FeatureSection.astro";
import FaqSection from "@/components/home/FaqSection.astro";
import FooterMinimal from "@/components/home/FooterMinimal.astro";

const hero = {
  title: "每天五分钟跟上 AI 生科",
  subtitle: "日报+博客+项目入口，一屏找到最该看的",
  primaryCta: { label: "进入博客", href: "/posts/" },
  secondaryCta: { label: "查看项目", href: "/projects/" },
};

const features = [
  {
    meta: "Daily Brief",
    title: "日报速览",
    description:
      "更快完成当天信息筛选，因为我们只保留可验证来源，同时不牺牲阅读体验。",
  },
  {
    meta: "Deep Read",
    title: "博客深读",
    description:
      "更快完成结构化理解，因为重点观点会被拆成清晰段落，同时不牺牲细节。",
  },
  {
    meta: "Project Entry",
    title: "项目入口",
    description:
      "更快进入当前在做的产品与实验，因为入口集中在一处，同时不牺牲更新节奏。",
  },
];

const faqItems = [
  {
    q: "更新频率是怎样的？",
    a: "北京时间每日 02:00 更新日报；博客在 07:00 与 18:00 更新。",
  },
  {
    q: "信息来源与筛选标准？",
    a: "覆盖预印本、顶刊/顶会、官方发布、开源社区与行业媒体，优先可验证来源。",
  },
  {
    q: "可以订阅吗？",
    a: "提供 RSS，地址为 /rss.xml，可用阅读器直接订阅。",
  },
];
---

<Layout>
  <HeaderMinimal />
  <main id="main-content" class="home-main app-layout">
    <div class="home-stack">
      <HeroSection {...hero} />
      {features.map((feature, index) => (
        <FeatureSection {...feature} flip={index % 2 === 1} />
      ))}
      <FaqSection items={faqItems} />
    </div>
  </main>
  <FooterMinimal />
</Layout>

<script>
  const prefersReduced = window.matchMedia(
    "(prefers-reduced-motion: reduce)"
  ).matches;
  const revealElements = Array.from(document.querySelectorAll(".reveal"));

  if (prefersReduced) {
    revealElements.forEach(el => el.classList.add("is-visible"));
  } else {
    const observer = new IntersectionObserver(
      entries => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            entry.target.classList.add("is-visible");
            observer.unobserve(entry.target);
          }
        });
      },
      { threshold: 0.2 }
    );

    revealElements.forEach(el => observer.observe(el));
  }
</script>
